function showMiniShopCartDropDownEvent(e,o,t,r){console.debug(e.keyCode),e.keyCode!=dojo.keys.DOWN_ARROW&&e.keyCode!=dojo.keys.ENTER||(showMiniShopCartDropDown(o,t,r),dojo.stopEvent(e))}function toggleMiniShopCartDropDownEvent(e,o,t,r){console.debug(e.keyCode),e.keyCode!=dojo.keys.DOWN_ARROW&&e.keyCode!=dojo.keys.ENTER||(toggleMiniShopCartDropDown(o,t,r),dojo.stopEvent(e))}function showMiniShopCartDropDown(e,o,t){if(!dropdownInit)if(dropdownInit=!0,dropdownUpdated)positionMiniShopCartDropDown(e,o,t);else{destroyDialog();var r={};r.status="load",r.relativeId=e,r.contentId=o,r.contentType=t,r.page_view="dropdown",wc.render.updateContext("MiniShopCartContentsContext",r)}}function toggleMiniShopCartDropDown(e,o,t){if(dojo.hasClass(e,"selected")){var r=dijit.byId(o);r&&r.hide()}else showMiniShopCartDropDown(e,o,t)}function positionMiniShopCartDropDown(e,o,t){var r=null,d=null;"orderItemsList"==t||"orderItemsListAutoClose"==t?(r=dropDownDlg,d=productAddedDropDownDlg):"orderItemAdded"==t&&(r=productAddedDropDownDlg,d=dropDownDlg);var n=dojo.byId(e),i=dojo.coords(n,!0),a=i.x,l=i.y+40;dojo.coords(dojo.byId("widget_minishopcart"),!0).w;8==dojo.isIE?dojo.coords(dojo.byId("widget_minishopcart"),!0).w:dojo.isIE>=7&&dojo.isIE<8?dojo.coords(dojo.byId("miniShopCartBody"),!0).w:dojo.isIE<7&&originalMiniCartWidth;var c=a;dojo.isIE,"ar-eg"!=dojo.locale&&"iw-il"!=dojo.locale||(c+=50),r&&(r.y=l);var u=function(){deactivate(document.getElementById("header")),dojo.addClass("widget_minishopcart","selected")},p=function(){dojo.removeClass("widget_minishopcart","selected")};if(!r){var s=document.getElementById(o),C=document.getElementById(o+"_ACCE_Label");(r=null!=C?new wc.widget.WCDialog({relatedSource:e,x:a,y:l,title:C.innerHTML,onShow:u,onHide:p},s):new wc.widget.WCDialog({relatedSource:e,x:a,y:l,onShow:u,onHide:p},s)).x=c}var m=null;d&&(m=d.displayStatus),r.displayStatus||null!=m&&m||(r.closeOnTimeOut=!1,r.autoClose=!1,"orderItemsList"==t||"orderItemsListAutoClose"==t?(dropdownDisplayed=!0,"orderItemsListAutoClose"==t&&(r.autoClose=!0),dropDownDlg=r,setTimeout(dojo.hitch(dropDownDlg,"show",null),5)):"orderItemAdded"==t&&(dojo.byId("MiniShopCartProductAddedWrapper").style.display="block",productAddedDropDownDlg=r,setTimeout(dojo.hitch(productAddedDropDownDlg,"show",null),5)),setTimeout(dojo.hitch(this,"hideUnderlayWrapper",""),5)),dojo.isIE<7&&(r.style.display="block"),dropdownInit=!1}function setMiniShopCartControllerURL(e){wc.render.getRefreshControllerById("MiniShoppingCartController").url=e}function updateCartCookie(){if(null!=document.getElementById("currentOrderQuantity")&&null!=document.getElementById("currentOrderAmount")&&null!=document.getElementById("currentOrderCurrency")&&null!=document.getElementById("currentOrderId")&&null!=document.getElementById("currentOrderLanguage")){var e=document.getElementById("currentOrderQuantity").value,o=document.getElementById("currentOrderAmount").value,t=document.getElementById("currentOrderCurrency").value,r=document.getElementById("currentOrderLanguage").value,d=document.getElementById("currentOrderId").value,n=getCookie("WC_CartOrderId_"+WCParamJS.storeId);null!=n&&(dojo.cookie("WC_CartOrderId_"+WCParamJS.storeId,null,{expires:90,path:"/"}),null!=getCookie("WC_CartTotal_"+n)&&dojo.cookie("WC_CartTotal_"+n,null,{expires:90,path:"/"})),dojo.cookie("WC_CartOrderId_"+WCParamJS.storeId,d,{path:"/"}),""!=d&&dojo.cookie("WC_CartTotal_"+d,e+";"+o+";"+t+";"+r,{path:"/"})}}function setProductAddedList(e){productAddedList=e}function populateProductAddedDropdown(){for(productId in productAddedList){var e=productAddedList[productId];if(null!=document.getElementById("MiniShopCartAddedProdName_"+productId)&&null!=e[0]&&(document.getElementById("MiniShopCartAddedProdName_"+productId).innerHTML=document.getElementById("product-display-name").innerHTML),null!=document.getElementById("MiniShopCartAddedProdImgSrc_"+productId)&&null!=e[1]&&(document.getElementById("MiniShopCartAddedProdImgSrc_"+productId).src=e[1],document.getElementById("MiniShopCartAddedProdImgSrc_"+productId).alt=e[0]),null!=document.getElementById("MiniShopCartAddedProdPrice_"+productId)&&null!=e[2]&&(document.getElementById("MiniShopCartAddedProdPrice_"+productId).innerHTML=e[2]),null!=document.getElementById("MiniShopCartAddedProdQty_"+productId)&&null!=e[3]&&(document.getElementById("MiniShopCartAddedProdQty_"+productId).innerHTML=e[3]),null!=document.getElementById("MiniShopCartAddedProdAttr_"+productId)&&null!=e[4]){document.getElementById("MiniShopCartAddedProdAttr_"+productId).innerHTML="";for(attrName in e[4])attrValue=e[4][attrName],null!=attrValue&&"undefined"!=attrValue&&(attrValue=attrValue.replace('\\\\"','"').replace(/&amp;/g,"&").replace(/&#039;/g,"'").replace(/&#034;/g,'"')),document.getElementById("MiniShopCartAddedProdAttr_"+productId).innerHTML+="<div>"+attrName+": "+attrValue+"</div>"}}dojo.topic.publish("ProductInfo_Reset")}function loadMiniCart(e,o){var t=!1,r=getCookie("WC_CartOrderId_"+WCParamJS.storeId);if(checkDeleteCartCookie())t=!0;else if(void 0!=r&&""==r){var d=document.getElementById("minishopcart_subtotal"),n=null;if(n=null!=(n="iw-il"==dojo.locale?dojo.currency.format(document.getElementById("currentOrderAmount").value,{symbol:"symbol",currency:e,locale:"he"}):dojo.currency.format(document.getElementById("currentOrderAmount").value,{symbol:"symbol",currency:e}))?n.replace("symbol",shoppingActionsJS.currencySymbol):document.getElementById("currentOrderAmount").value,null!=d&&(d.innerHTML="\n "+n+"\n "),null!=(l=document.getElementById("minishopcart_total"))){c=document.getElementById("currentOrderQuantity").value;l.innerHTML="\n "+c+"\n "}}else if(void 0!=r&&""!=r){var i=getCookie("WC_CartTotal_"+r);if(void 0!=i&&null!=i&&""!=i){var a=i.split(";");if(null!=a&&4==a.length)if(a[2]==e&&a[3]==o){if(null!=(d=document.getElementById("minishopcart_subtotal"))){n=null;n=null!=(n="iw-il"==dojo.locale?dojo.currency.format(a[1].toString(),{symbol:"symbol",currency:e,locale:"he"}):dojo.currency.format(a[1].toString(),{symbol:"symbol",currency:e}))?n.replace("symbol",shoppingActionsJS.currencySymbol):a[1].toString(),d.innerHTML="\n "+n+"\n "}var l=document.getElementById("minishopcart_total");if(null!=l){var c=a[0].toString();l.innerHTML="\n "+c+"\n "}}else t=!0;else t=!0}else t=!0}else t=!0;1==t&&wc.render.updateContext("MiniShoppingCartContext",{status:"load"})}function handleMiniCartHover(){dojo.connect(document.getElementById("widget_minishopcart"),"onmouseover",function(){timer=setTimeout(function(){showMiniShopCartDropDown("widget_minishopcart","quick_cart_container","orderItemsListAutoClose")},1e3)}),dojo.connect(document.getElementById("widget_minishopcart"),"onmouseout",function(){clearTimeout(timer)})}function setDeleteCartCookie(){dojo.cookie("WC_DeleteCartCookie_"+WCParamJS.storeId,!0,{path:"/"})}function checkDeleteCartCookie(){var e=getCookie("WC_DeleteCartCookie_"+WCParamJS.storeId);return void 0!=e&&""!=e&&"true"==e}function resetDeleteCartCookie(){null!=getCookie("WC_DeleteCartCookie_"+WCParamJS.storeId)&&dojo.cookie("WC_DeleteCartCookie_"+WCParamJS.storeId,null,{expires:-1,path:"/"})}var order_updated={AjaxAddOrderItem:"AjaxAddOrderItem",AddOrderItem:"AddOrderItem",AjaxAddOrderItemWithShipingInfo:"AjaxAddOrderItemWithShipingInfo",AjaxDeleteOrderItem:"AjaxDeleteOrderItem",AjaxUpdateOrderItem:"AjaxUpdateOrderItem",AjaxUpdateOrderShippingInfo:"AjaxUpdateOrderShippingInfo",AjaxOrderCalculate:"AjaxOrderCalculate",AjaxLogoff:"AjaxLogoff",AjaxSetPendingOrder:"AjaxSetPendingOrder",AjaxUpdatePendingOrder:"AjaxUpdatePendingOrder",AjaxSingleOrderCancel:"AjaxSingleOrderCancel",AjaxUpdateRewardOption:"AjaxUpdateRewardOption"},dropdownUpdated=!1,dropdownInit=!1,timer,productAddedList=new Object;wc.render.declareContext("MiniShoppingCartContext",{status:"init"},""),wc.render.declareContext("MiniShopCartContentsContext",{status:"init",relativeId:"",contentId:"",contentType:""},""),wc.render.declareContext("MiniShopCartDropDownContext",null,""),wc.render.declareRefreshController({id:"MiniShoppingCartController",renderContext:wc.render.getContextById("MiniShoppingCartContext"),url:"",formId:"",modelChangedHandler:function(e,o){this.renderContext;if(e.actionId in order_updated||"AjaxDeleteOrderItemForShippingBillingPage"==e.actionId){var t=[];if("AddOrderItem"==e.actionId){t.addedOrderItemId=e.orderItemId+"",showDropdown=!0;var r="";for(productId in productAddedList)""!=r&&(r+=","),r+=productId;t.availableInfoOrderItemIds=r}t.deleteCartCookie=!0,o.refresh(t)}},renderContextChangedHandler:function(e,o){var t=this,r=this.renderContext;t.testForChangedRC(["status"])&&(r.properties.deleteCartCookie=!0,o.refresh(r.properties))},postRefreshHandler:function(e){this.renderContext;destroyDialog("MiniShopCartProductAdded"),showDropdown&&(positionMiniShopCartDropDown("widget_minishopcart","MiniShopCartProductAdded","orderItemAdded"),showDropdown=!1),multiSessionEnabled||updateCartCookie(),populateProductAddedDropdown(),multiSessionEnabled||resetDeleteCartCookie()}}),wc.render.declareRefreshController({id:"MiniShopCartContentsController",renderContext:wc.render.getContextById("MiniShopCartContentsContext"),url:"",formId:"",modelChangedHandler:function(e,o){this.renderContext;(e.actionId in order_updated||"AjaxDeleteOrderItemForShippingBillingPage"==e.actionId)&&(dropdownUpdated=!1)},renderContextChangedHandler:function(e,o){var t=this.renderContext;dropdownUpdated||(t.properties.fetchCartContents=!0,dropdownUpdated=!0,o.refresh(t.properties))},postRefreshHandler:function(e){var o=this.renderContext;positionMiniShopCartDropDown(o.properties.relativeId,o.properties.contentId,o.properties.contentType)}}),dojo.topic.subscribe("ProductInfo_Added",setProductAddedList),MiniShopCartDisplayJS={showMiniCart:function(){var e={mode:"MINI_CART"};$.ajax({url:"HVTMiniCartDisplayCmd",data:e,dataType:"html",beforeSend:function(e,o){cursor_wait()},error:function(e,o,t){MiniShopCartDisplayJS.showErrorDialog("Mini Cart Error","An error occurred attempting to load mini cart.")},success:function(e,o,t){try{if(CommonUtilsJS.isSessionExpired(e))return void MiniShopCartDisplayJS.processTimeout();if(CommonUtilsJS.isCookieInvalid(e))return void CommonUtilsJS.processInvalidCookie(MiniShopCartDisplayUIJS.INVALID_COOKIE_URL);var r=$(e).filter("#MINICARTERROR");if(r.length){r.html();MiniShopCartDisplayJS.miniCartPopup(e)}else MiniShopCartDisplayJS.miniCartPopup(e)}catch(e){console.log(e),this.error()}},complete:function(e,o){cursor_clear()}})},miniCartPopup:function(e){$("#miniCartPopup").html(e),$("#miniCartPopup").dialog({title:"Shopping Cart",modal:!0,height:"auto",buttons:{GoToCart1:{text:"Go to Cart",id:"GotoCartButton1",click:function(){window.location=MiniShopCartDisplayUIJS.SHOPPING_CART_URL}}},close:function(){$(this).dialog("close")}}),$(".ui-dialog-titlebar-close").attr("id","MiniShopCartCloseButton_1")},showErrorDialog:function(e,o,t){$("#errorPopup").html(o),$("#errorPopup").dialog({title:e,modal:!0,position:{my:"top",at:"top+30%"},width:"500",height:"220",buttons:{GoToCart1:{text:"Go to Cart",id:"GotoCartButton3",click:function(){window.location=MiniShopCartDisplayUIJS.SHOPPING_CART_URL}},Ok:function(){$(this).dialog("close"),t&&t.call()}}})},processTimeout:function(){CommonUtilsJS.redirectToURL(MiniShopCartDisplayUIJS.TIMEOUT_URL)}};